<div class="admin-container">
  <header class="admin-header">
    <div class="header-content">
      <h1>Painel Administrativo</h1>
      <div class="header-actions">
        <span class="welcome-text">Bem-vindo, Administrador!</span>
        <button class="logout-button" (click)="logout()">Sair</button>
      </div>
    </div>
  </header>

  <main class="admin-main">
    <div class="dashboard-stats">
      <div class="stat-card">
        <h3>Total de Inscri√ß√µes</h3>
        <p class="stat-number">{{ inscricoes.length }}</p>
      </div>
      <div class="stat-card">
        <h3>Pendentes</h3>
        <p class="stat-number">{{ getInscricoesPorStatus('PENDENTE') }}</p>
      </div>
      <!-- <div class="stat-card">
        <h3>Parcial 01</h3>
        <p class="stat-number">{{ getInscricoesPorStatus('PARCIAL_01') }}</p>
      </div>
      <div class="stat-card">
        <h3>Parcial 02</h3>
        <p class="stat-number">{{ getInscricoesPorStatus('PARCIAL_02') }}</p>
      </div>
      <div class="stat-card">
        <h3>Parcial 03</h3>
        <p class="stat-number">{{ getInscricoesPorStatus('PARCIAL_02') }}</p>
      </div>
      <div class="stat-card">
        <h3>Parcial 04</h3>
        <p class="stat-number">{{ getInscricoesPorStatus('PARCIAL_02') }}</p>
      </div> -->
      <div class="stat-card">
        <h3>Aprovadas</h3>
        <p class="stat-number">{{ getInscricoesPorStatus('APROVADO') }}</p>
      </div>
      <div class="stat-card">
        <h3>Rejeitadas</h3>
        <p class="stat-number">{{ getInscricoesPorStatus('REJEITADO') }}</p>
      </div>
    </div>

    <div class="dashboard-stats secondary-stats">
      <div class="stat-card">
        <h3>1¬∫ Lote</h3>
        <p class="stat-number">{{ getInscricoesPorLote('lote1') }}</p>
      </div>
      <div class="stat-card">
        <h3>2¬∫ Lote</h3>
        <p class="stat-number">{{ getInscricoesPorLote('lote2') }}</p>
      </div>
      <!-- <div class="stat-card">
        <h3>PIX</h3>
        <p class="stat-number">{{ getInscricoesPorTipoPagamento('pix') }}</p>
      </div>
      <div class="stat-card">
        <h3>Cart√£o</h3>
        <p class="stat-number">{{ getInscricoesPorTipoPagamento('cartao') }}</p>
      </div>
      <div class="stat-card">
        <h3>Carn√™</h3>
        <p class="stat-number">{{ getInscricoesPorTipoPagamento('carne') }}</p>
      </div> -->
    </div>

    <div class="filters-section">
      <div class="search-box">
        <input
          type="text"
          [(ngModel)]="searchTerm"
          placeholder="Buscar por nome, email ou telefone..."
          class="search-input"
        >
      </div>
      <div class="filter-group">
        <select [(ngModel)]="statusFilter" class="filter-select">
          <option value="">Todos os status</option>
          <option value="PENDENTE">Pendente</option>
          <option value="PARCIAL_01">Parcial 01</option>
          <option value="PARCIAL_02">Parcial 02</option>
          <option value="PARCIAL_03">Parcial 03</option>
          <option value="PARCIAL_04">Parcial 04</option>
          <option value="APROVADO">Aprovado</option>
          <option value="REJEITADO">Rejeitado</option>
        </select>
      </div>
      <div class="filter-group">
        <select [(ngModel)]="loteFilter" class="filter-select">
          <option value="">Todos os lotes</option>
          <option value="lote1">1¬∫ Lote - R$ 250,00</option>
          <option value="lote2">2¬∫ Lote - R$ 300,00</option>
        </select>
      </div>
      <div class="filter-group">
        <select [(ngModel)]="paymentMethodFilter" class="filter-select">
          <option value="">Todos os pagamentos</option>
          <option value="pix">PIX</option>
          <option value="cartao">Cart√£o</option>
          <option value="carne">Carn√™</option>
        </select>
      </div>
      <div class="filter-group">
        <select [(ngModel)]="itemsPerPage" (change)="alterarItensPorPagina(+$any($event.target).value)" class="filter-select">
          <option value="5">5 por p√°gina</option>
          <option value="10">10 por p√°gina</option>
          <option value="20">20 por p√°gina</option>
          <option value="50">50 por p√°gina</option>
        </select>
      </div>
      <div class="filter-actions">
        <button class="clear-filters-button" (click)="limparFiltros()">
          üóëÔ∏è Limpar Filtros
        </button>
        <button class="refresh-button" (click)="carregarInscricoes()" [disabled]="isLoading">
          {{ isLoading ? 'Carregando...' : 'Atualizar' }}
        </button>
      </div>
    </div>

    <div class="table-container">
      <div *ngIf="isLoading" class="loading">
        <p>Carregando inscri√ß√µes...</p>
      </div>

      <div *ngIf="errorMessage" class="error-message">
        {{ errorMessage }}
      </div>

      <div *ngIf="!isLoading && !errorMessage" class="table-wrapper">
        <table class="inscricoes-table">
          <thead>
            <tr>
              <th>Nome</th>
              <th>Pag.</th>
              <th>Email</th>
              <th>Telefone</th>
              <th>Lote</th>
              <th>Status</th>
              <!-- <th>Contrato</th> -->
              <th>A√ß√µes</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let inscricao of inscricoesFiltradas" class="table-row" style="color: #000;">
              <td>
                <div class="inscricao-info">
                  <strong>{{ inscricao.fullName }}</strong>
                  <small>{{ inscricao.gender }}</small>
                </div>
              </td>
              <td>{{ inscricao.paymentMethod }}</td>
              <td>{{ inscricao.email }}</td>
              <td>{{ inscricao.phone }}</td>
              <td>{{ inscricao.registrationLot }}</td>
              <td>
                <span class="status-badge" [ngClass]="getStatusClass(inscricao.status)">
                  {{ inscricao.status || 'PENDENTE' }}
                </span>
              </td>
              <!-- <td>
                <button 
                  class="details-button" 
                  (click)="enviarContrato(inscricao)"
                  title="Enviar contrato por email"
                >
                  ‚úâÔ∏è Contrato
                </button>
              </td> -->
              <td>
                <div class="actions">
                  <button 
                    class="details-button" 
                    (click)="abrirDetalhes(inscricao)"
                    title="Ver detalhes"
                  >
                    üëÅÔ∏è
                  </button>
                  <select 
                    (change)="atualizarStatus(inscricao, $any($event.target).value)"
                    class="status-select-small"
                    [value]="inscricao.status || 'PENDENTE'"
                    [title]="getStatusDescription(inscricao.status || 'PENDENTE')"
                  >
                    <option 
                      *ngFor="let status of getStatusDisponiveis(inscricao.paymentMethod)" 
                      [value]="status"
                      [selected]="status === (inscricao.status || 'PENDENTE')"
                    >
                      {{ status }}
                    </option>
                  </select>
                  <button 
                    class="delete-button" 
                    (click)="removerInscricao(inscricao)"
                    title="Remover inscri√ß√£o"
                  >
                    üóëÔ∏è
                  </button>
                </div>
              </td>
            </tr>
          </tbody>
        </table>

        <div *ngIf="inscricoesFiltradas.length === 0" class="no-results">
          <p>Nenhuma inscri√ß√£o encontrada.</p>
        </div>

        <!-- Informa√ß√µes de pagina√ß√£o -->
        <div *ngIf="totalInscricoesFiltradas > 0" class="pagination-info">
          <p>
            Mostrando {{ (currentPage - 1) * itemsPerPage + 1 }} a 
            {{ Math.min(currentPage * itemsPerPage, totalInscricoesFiltradas) }} de 
            {{ totalInscricoesFiltradas }} inscri√ß√µes
          </p>
        </div>

        <!-- Controles de pagina√ß√£o -->
        <div *ngIf="totalPages > 1" class="pagination-controls">
          <button 
            class="pagination-button" 
            (click)="paginaAnterior()" 
            [disabled]="currentPage === 1"
            title="P√°gina anterior"
          >
            ‚Üê Anterior
          </button>

          <div class="pagination-numbers">
            <button 
              *ngFor="let pagina of paginasVisiveis" 
              class="pagination-number" 
              [class.active]="pagina === currentPage"
              (click)="irParaPagina(pagina)"
            >
              {{ pagina }}
            </button>
          </div>

          <button 
            class="pagination-button" 
            (click)="proximaPagina()" 
            [disabled]="currentPage === totalPages"
            title="Pr√≥xima p√°gina"
          >
            Pr√≥xima ‚Üí
          </button>
        </div>
      </div>
    </div>
  </main>
</div>

<!-- Modal de Detalhes -->
<div *ngIf="showDetailsModal && selectedInscricao" class="modal-overlay" (click)="fecharDetalhes()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2>Detalhes da Inscri√ß√£o</h2>
      <button class="close-button" (click)="fecharDetalhes()">√ó</button>
    </div>
    
    <div class="modal-body">
      <div class="details-grid">
        <!-- Informa√ß√µes Pessoais -->
        <div class="detail-section">
          <h3>Informa√ß√µes Pessoais</h3>
          <div class="detail-item">
            <strong>Nome Completo:</strong> {{ selectedInscricao.fullName }}
          </div>
          <div class="detail-item">
            <strong>Data de Nascimento:</strong> {{ formatarData(selectedInscricao.birthDate) }}
          </div>
          <div class="detail-item">
            <strong>Idade:</strong> {{ selectedInscricao.age }} anos
          </div>
          <div class="detail-item">
            <strong>G√™nero:</strong> {{ selectedInscricao.gender }}
          </div>
          <div class="detail-item">
            <strong>Telefone:</strong> {{ selectedInscricao.phone }}
          </div>
          <div class="detail-item">
            <strong>Email:</strong> {{ selectedInscricao.email }}
          </div>
          <div class="detail-item">
            <strong>Endere√ßo:</strong> {{ selectedInscricao.address }}
          </div>
          <div class="detail-item">
            <strong>Rede Social:</strong> {{ selectedInscricao.socialMedia }}
          </div>
        </div>

        <!-- Contato de Emerg√™ncia -->
        <div class="detail-section">
          <h3>Contato de Emerg√™ncia</h3>
          <div class="detail-item">
            <strong>Nome:</strong> {{ selectedInscricao.emergencyContactName }}
          </div>
          <div class="detail-item">
            <strong>Telefone:</strong> {{ selectedInscricao.emergencyContactPhone }}
          </div>
          <div class="detail-item">
            <strong>Relacionamento:</strong> {{ selectedInscricao.emergencyContactRelationship }}
          </div>
        </div>

        <!-- Informa√ß√µes Religiosas -->
        <div class="detail-section">
          <h3>Informa√ß√µes Religiosas</h3>
          <div class="detail-item">
            <strong>Membro da Lagoinha:</strong> {{ selectedInscricao.isLagoinhaMember }}
          </div>
          <div class="detail-item">
            <strong>Igreja:</strong> {{ selectedInscricao.churchName }}
          </div>
          <div class="detail-item">
            <strong>Participa√ß√£o em Minist√©rio:</strong> {{ selectedInscricao.ministryParticipation }}
          </div>
          <div class="detail-item">
            <strong>Teste de Minist√©rio:</strong> {{ selectedInscricao.hasMinistryTest }}
          </div>
          <div class="detail-item" *ngIf="selectedInscricao.ministryTestResults">
            <strong>Resultados do Teste:</strong> {{ selectedInscricao.ministryTestResults }}
          </div>
        </div>

        <!-- Informa√ß√µes do Acampamento -->
        <div class="detail-section">
          <h3>Informa√ß√µes do Acampamento</h3>
          <div class="detail-item">
            <strong>Lote:</strong> {{ selectedInscricao.registrationLot }}
          </div>
          <div class="detail-item">
            <strong>M√©todo de Pagamento:</strong> {{ selectedInscricao.paymentMethod }}
          </div>
          <div class="detail-item">
            <strong>Tamanho da Camiseta:</strong> {{ selectedInscricao.shirtSize }}
          </div>
        </div>

        <!-- Informa√ß√µes M√©dicas -->
        <div class="detail-section">
          <h3>Informa√ß√µes M√©dicas</h3>
          <div class="detail-item">
            <strong>Alergia:</strong> {{ selectedInscricao.hasAllergy }}
          </div>
          <div class="detail-item" *ngIf="selectedInscricao.allergyDetails">
            <strong>Detalhes da Alergia:</strong> {{ selectedInscricao.allergyDetails }}
          </div>
          <div class="detail-item" *ngIf="selectedInscricao.usesMedication">
            <strong>Usa Medica√ß√£o:</strong> {{ selectedInscricao.usesMedication }}
          </div>
          <div class="detail-item" *ngIf="selectedInscricao.medicationDetails">
            <strong>Detalhes da Medica√ß√£o:</strong> {{ selectedInscricao.medicationDetails }}
          </div>
          <div class="detail-item">
            <strong>Restri√ß√£o Alimentar:</strong> {{ selectedInscricao.dietaryRestriction }}
          </div>
        </div>

        <!-- Pedido de Ora√ß√£o -->
        <div class="detail-section">
          <h3>Pedido de Ora√ß√£o</h3>
          <div class="detail-item">
            <strong>Pedido:</strong> {{ selectedInscricao.prayerRequest }}
          </div>
        </div>

        <!-- Autoriza√ß√µes -->
        <div class="detail-section">
          <h3>Autoriza√ß√µes</h3>
          <div class="detail-item">
            <strong>Autoriza√ß√£o de Imagem:</strong> {{ formatarBoolean(selectedInscricao.imageAuthorization) }}
          </div>
          <div class="detail-item">
            <strong>Ci√™ncia da An√°lise:</strong> {{ formatarBoolean(selectedInscricao.analysisAwareness) }}
          </div>
          <div class="detail-item">
            <strong>Ci√™ncia dos Termos:</strong> {{ formatarBoolean(selectedInscricao.termsAwareness) }}
          </div>
          <div class="detail-item">
            <strong>Declara√ß√£o de Verdade:</strong> {{ formatarBoolean(selectedInscricao.truthDeclaration) }}
          </div>
        </div>

        <!-- Informa√ß√µes do Sistema -->
        <div class="detail-section">
          <h3>Informa√ß√µes do Sistema</h3>
          <div class="detail-item">
            <strong>Status:</strong> 
            <span class="status-badge" [ngClass]="getStatusClass(selectedInscricao.status)">
              {{ selectedInscricao.status || 'pendente' }}
            </span>
          </div>
          <div class="detail-item">
            <strong>Data de Cria√ß√£o:</strong> {{ formatarDataCompleta(selectedInscricao.createdAt) }}
          </div>
          <div class="detail-item" *ngIf="selectedInscricao.updatedAt">
            <strong>√öltima Atualiza√ß√£o:</strong> {{ formatarDataCompleta(selectedInscricao.updatedAt) }}
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
