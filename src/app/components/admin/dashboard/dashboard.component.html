<div class="admin-container">
  <header class="admin-header">
    <div class="header-content">
      <h1>Painel Administrativo</h1>
      <div class="header-actions">
        <span class="welcome-text">Bem-vindo, Administrador!</span>
        <button class="logout-button" (click)="logout()">Sair</button>
      </div>
    </div>
  </header>

  <main class="admin-main">
    <div class="dashboard-stats">
      <div class="stat-card">
        <h3>Total de Inscri√ß√µes</h3>
        <p class="stat-number">{{ inscricoes.length }}</p>
      </div>
      <div class="stat-card">
        <h3>Pendentes</h3>
        <p class="stat-number">{{ getInscricoesPorStatus('pendente') }}</p>
      </div>
      <div class="stat-card">
        <h3>Aprovadas</h3>
        <p class="stat-number">{{ getInscricoesPorStatus('aprovado') }}</p>
      </div>
      <div class="stat-card">
        <h3>Rejeitadas</h3>
        <p class="stat-number">{{ getInscricoesPorStatus('rejeitado') }}</p>
      </div>
    </div>

    <div class="filters-section">
      <div class="search-box">
        <input
          type="text"
          [(ngModel)]="searchTerm"
          placeholder="Buscar por nome, email ou telefone..."
          class="search-input"
        >
      </div>
      <div class="status-filter">
        <select [(ngModel)]="statusFilter" class="status-select">
          <option value="">Todos os status</option>
          <option value="pendente">Pendente</option>
          <option value="aprovado">Aprovado</option>
          <option value="rejeitado">Rejeitado</option>
        </select>
      </div>
      <button class="refresh-button" (click)="carregarInscricoes()" [disabled]="isLoading">
        {{ isLoading ? 'Carregando...' : 'Atualizar' }}
      </button>
    </div>

    <div class="table-container">
      <div *ngIf="isLoading" class="loading">
        <p>Carregando inscri√ß√µes...</p>
      </div>

      <div *ngIf="errorMessage" class="error-message">
        {{ errorMessage }}
      </div>

      <div *ngIf="!isLoading && !errorMessage" class="table-wrapper">
        <table class="inscricoes-table">
          <thead>
            <tr>
              <th>Nome</th>
              <th>Pag.</th>
              <th>Email</th>
              <th>Telefone</th>
              <th>Lote</th>
              <th>Status</th>
              <th>A√ß√µes</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let inscricao of inscricoesFiltradas" class="table-row" style="color: #000;">
              <td>
                <div class="inscricao-info">
                  <strong>{{ inscricao.fullName }}</strong>
                  <small>{{ inscricao.gender }}</small>
                </div>
              </td>
              <td>{{ inscricao.paymentMethod }}</td>
              <td>{{ inscricao.email }}</td>
              <td>{{ inscricao.phone }}</td>
              <td>{{ inscricao.registrationLot }}</td>
              <td>
                <span class="status-badge" [ngClass]="getStatusClass(inscricao.status)">
                  {{ inscricao.status || 'pendente' }}
                </span>
              </td>
              <td>
                <div class="actions">
                  <button 
                    class="details-button" 
                    (click)="abrirDetalhes(inscricao)"
                    title="Ver detalhes"
                  >
                    üëÅÔ∏è
                  </button>
                  <select 
                    (change)="atualizarStatus(inscricao, $any($event.target).value)"
                    class="status-select-small"
                    [value]="inscricao.status || 'pendente'"
                  >
                    <option value="pendente">Pendente</option>
                    <option value="aprovado">Aprovado</option>
                    <option value="rejeitado">Rejeitado</option>
                  </select>
                  <button 
                    class="delete-button" 
                    (click)="removerInscricao(inscricao)"
                    title="Remover inscri√ß√£o"
                  >
                    üóëÔ∏è
                  </button>
                </div>
              </td>
            </tr>
          </tbody>
        </table>

        <div *ngIf="inscricoesFiltradas.length === 0" class="no-results">
          <p>Nenhuma inscri√ß√£o encontrada.</p>
        </div>
      </div>
    </div>
  </main>
</div>

<!-- Modal de Detalhes -->
<div *ngIf="showDetailsModal && selectedInscricao" class="modal-overlay" (click)="fecharDetalhes()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2>Detalhes da Inscri√ß√£o</h2>
      <button class="close-button" (click)="fecharDetalhes()">√ó</button>
    </div>
    
    <div class="modal-body">
      <div class="details-grid">
        <!-- Informa√ß√µes Pessoais -->
        <div class="detail-section">
          <h3>Informa√ß√µes Pessoais</h3>
          <div class="detail-item">
            <strong>Nome Completo:</strong> {{ selectedInscricao.fullName }}
          </div>
          <div class="detail-item">
            <strong>Data de Nascimento:</strong> {{ formatarData(selectedInscricao.birthDate) }}
          </div>
          <div class="detail-item">
            <strong>Idade:</strong> {{ selectedInscricao.age }} anos
          </div>
          <div class="detail-item">
            <strong>G√™nero:</strong> {{ selectedInscricao.gender }}
          </div>
          <div class="detail-item">
            <strong>Telefone:</strong> {{ selectedInscricao.phone }}
          </div>
          <div class="detail-item">
            <strong>Email:</strong> {{ selectedInscricao.email }}
          </div>
          <div class="detail-item">
            <strong>Endere√ßo:</strong> {{ selectedInscricao.address }}
          </div>
          <div class="detail-item">
            <strong>Rede Social:</strong> {{ selectedInscricao.socialMedia }}
          </div>
        </div>

        <!-- Contato de Emerg√™ncia -->
        <div class="detail-section">
          <h3>Contato de Emerg√™ncia</h3>
          <div class="detail-item">
            <strong>Nome:</strong> {{ selectedInscricao.emergencyContactName }}
          </div>
          <div class="detail-item">
            <strong>Telefone:</strong> {{ selectedInscricao.emergencyContactPhone }}
          </div>
          <div class="detail-item">
            <strong>Relacionamento:</strong> {{ selectedInscricao.emergencyContactRelationship }}
          </div>
        </div>

        <!-- Informa√ß√µes Religiosas -->
        <div class="detail-section">
          <h3>Informa√ß√µes Religiosas</h3>
          <div class="detail-item">
            <strong>Membro da Lagoinha:</strong> {{ selectedInscricao.isLagoinhaMember }}
          </div>
          <div class="detail-item">
            <strong>Igreja:</strong> {{ selectedInscricao.churchName }}
          </div>
          <div class="detail-item">
            <strong>Participa√ß√£o em Minist√©rio:</strong> {{ selectedInscricao.ministryParticipation }}
          </div>
          <div class="detail-item">
            <strong>Teste de Minist√©rio:</strong> {{ selectedInscricao.hasMinistryTest }}
          </div>
          <div class="detail-item" *ngIf="selectedInscricao.ministryTestResults">
            <strong>Resultados do Teste:</strong> {{ selectedInscricao.ministryTestResults }}
          </div>
        </div>

        <!-- Informa√ß√µes do Acampamento -->
        <div class="detail-section">
          <h3>Informa√ß√µes do Acampamento</h3>
          <div class="detail-item">
            <strong>Lote:</strong> {{ selectedInscricao.registrationLot }}
          </div>
          <div class="detail-item">
            <strong>M√©todo de Pagamento:</strong> {{ selectedInscricao.paymentMethod }}
          </div>
          <div class="detail-item">
            <strong>Tamanho da Camiseta:</strong> {{ selectedInscricao.shirtSize }}
          </div>
        </div>

        <!-- Informa√ß√µes M√©dicas -->
        <div class="detail-section">
          <h3>Informa√ß√µes M√©dicas</h3>
          <div class="detail-item">
            <strong>Alergia:</strong> {{ selectedInscricao.hasAllergy }}
          </div>
          <div class="detail-item" *ngIf="selectedInscricao.allergyDetails">
            <strong>Detalhes da Alergia:</strong> {{ selectedInscricao.allergyDetails }}
          </div>
          <div class="detail-item" *ngIf="selectedInscricao.usesMedication">
            <strong>Usa Medica√ß√£o:</strong> {{ selectedInscricao.usesMedication }}
          </div>
          <div class="detail-item" *ngIf="selectedInscricao.medicationDetails">
            <strong>Detalhes da Medica√ß√£o:</strong> {{ selectedInscricao.medicationDetails }}
          </div>
          <div class="detail-item">
            <strong>Restri√ß√£o Alimentar:</strong> {{ selectedInscricao.dietaryRestriction }}
          </div>
        </div>

        <!-- Pedido de Ora√ß√£o -->
        <div class="detail-section">
          <h3>Pedido de Ora√ß√£o</h3>
          <div class="detail-item">
            <strong>Pedido:</strong> {{ selectedInscricao.prayerRequest }}
          </div>
        </div>

        <!-- Autoriza√ß√µes -->
        <div class="detail-section">
          <h3>Autoriza√ß√µes</h3>
          <div class="detail-item">
            <strong>Autoriza√ß√£o de Imagem:</strong> {{ formatarBoolean(selectedInscricao.imageAuthorization) }}
          </div>
          <div class="detail-item">
            <strong>Ci√™ncia da An√°lise:</strong> {{ formatarBoolean(selectedInscricao.analysisAwareness) }}
          </div>
          <div class="detail-item">
            <strong>Ci√™ncia dos Termos:</strong> {{ formatarBoolean(selectedInscricao.termsAwareness) }}
          </div>
          <div class="detail-item">
            <strong>Declara√ß√£o de Verdade:</strong> {{ formatarBoolean(selectedInscricao.truthDeclaration) }}
          </div>
        </div>

        <!-- Informa√ß√µes do Sistema -->
        <div class="detail-section">
          <h3>Informa√ß√µes do Sistema</h3>
          <div class="detail-item">
            <strong>Status:</strong> 
            <span class="status-badge" [ngClass]="getStatusClass(selectedInscricao.status)">
              {{ selectedInscricao.status || 'pendente' }}
            </span>
          </div>
          <div class="detail-item">
            <strong>Data de Cria√ß√£o:</strong> {{ formatarDataCompleta(selectedInscricao.createdAt) }}
          </div>
          <div class="detail-item" *ngIf="selectedInscricao.updatedAt">
            <strong>√öltima Atualiza√ß√£o:</strong> {{ formatarDataCompleta(selectedInscricao.updatedAt) }}
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
